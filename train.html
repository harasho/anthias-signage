<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="refresh" content="300">
  <title>運行情報</title>
  <style>
    body {
      font-family: sans-serif;
      font-size: 2em;
      background: #fff;
      color: #000;
      padding: 20px;
    }
    .line {
      margin-bottom: 1em;
    }
  </style>
</head>
<body>
  <h1>運行情報（リアルタイム）</h1>
  <div id="info">読み込み中...</div>

  <script>
    const lines = [
      { name: "東急東横線", url: "https://transit.yahoo.co.jp/traininfo/rss/23.xml" },
      { name: "京急本線", url: "https://transit.yahoo.co.jp/traininfo/rss/68.xml" },
      { name: "南武線", url: "https://transit.yahoo.co.jp/traininfo/rss/42.xml" },
      { name: "横須賀線", url: "https://transit.yahoo.co.jp/traininfo/rss/33.xml" },
      { name: "湘南新宿ライン", url: "https://transit.yahoo.co.jp/traininfo/rss/179.xml" }
    ];

    async function fetchRSS(url, lineName) {
      const response = await fetch(`https://api.allorigins.win/get?url=${encodeURIComponent(url)}`);
      const data = await response.json();
      const parser = new DOMParser();
      const xml = parser.parseFromString(data.contents, "text/xml");
      const item = xml.querySelector("item > title")?.textContent || "取得失敗";
      return `<div class="line">${lineName}：${item}</div>`;
    }

    async function load() {
      const results = await Promise.all(lines.map(line => fetchRSS(line.url, line.name)));
      document.getElementById("info").innerHTML = results.join("");
    }

    load();
    setInterval(load, 300000); // 5分ごと更新
  </script>
</body>
</html>
